<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
p {
  margin: 0px 0px 0px 50px;
}
td {
  width: 110px;
  padding-left: 15px;
}
.tableButtons {
  background-color: white;
  border: 2px solid darkslategray;
  margin-left: 50px;
  margin-top: 5px;
}
.subtitle{
  color: darkslategray;
  margin: 0px 0px 0px 50px;
}

.tierSelectionBar button {
  padding: 2px 5px;
  overflow: hidden;
  background-color: darkslategray;
  width: 100px;
  float:left;
  color: white;
  text-align: center;
  border: 2px solid darkslategray;
  margin: 0px 0px 0px 50px;
}
.tierSelection button:not(:last-child){
  border-right: none;
}
.tierSelectionBar button:not(:first-child){
  margin: 0px;
}
.tierSelectionBar:after {
  content: "";
  clear: both;
  display: table;
}
.tierSelectionBar button:focus {
  background-color: #ded1d1;
  color: black;
}
.tierSelectionBar button:hover{
  opacity: 0.9;
}

.tbutton, .sitButton, .accDec, .RnameText, .tierSelectionBar button, .tableButtons {
    height: 25px;
    cursor: pointer;
    font-size: 12px;
}
.tbutton {
  background-color: white;
  border-left: 2px solid darkslategray;
  border-top: 2px solid darkslategray;
  border-bottom: 2px solid darkslategray;
  border-right: 1px solid darkslategray;
  text-align: center;
  padding: 0 0 0 25px;
  display: inline-block;
  border-radius: 8px 0 0 8px;
  width: 70px;
}
button:focus {outline:0;}
.tbutton:hover {
  opacity: 0.9;
}
.sitButton {
  width: 25px;
  border-radius: 0 8px 8px 0;
  background-color: darkslategray;
  border: 2px solid darkslategray;
  position: absolute;
  display: inline;
  text-align: center;
}
.sitButton:hover {
  opacity: 0.9;
}
.RnameText, .accDec {
  background-color: white;
  border: 2px solid white;
  box-shadow: none;
}
.accDec {
  text-align: center;
  width: 10px;
  margin-right: 3px;
  font-size: 12px;
}
.RnameText {
  text-align: left;
  width: 90px;
  display: inline-block;
}
.counttable {
  height: 50px;
  text-align: center;
  font-size: 12px;
}
.decl {}
.acces {}
.notchosen {}
  .standbyclass {}
    .notstandby {}
</style>
<script>
function Raider(id, name, role, offrole){
  this.idN = id;
  this.nameN = name;
  this.roleN = role;
  this.offroleN = offrole;
}
function Boss(bossname, mintanks, maxtanks, minhealers, maxhealers, tier){
  this.Bname = bossname;
  this.Bmintanks = mintanks;
  this.Bmaxtanks = maxtanks;
  this.Bminhealers = minhealers;
  this.Bmaxhealers = maxhealers;
  this.Btier = tier;
}
Tier1 = ["Garothi", "Felhounds", "High Command", "Eonar", "Hasabel"];
Tier2 = ["Imonar", "Kin", "Vari", "Coven"];
Tier3 = ["Aggramar", "Argus"];
tiers = ["Tier1", "Tier2", "Tier3"];
bossObjectArray = [];
for (i=0; i<3; i++){
  if (i===0){
    Tier = ["Garothi", "Felhounds", "High Command", "Eonar", "Hasabel"];
    tierName = "Tier0";
    for (i=0; i <5; i++){
    bossname = Tier[i];
    boss = "Boss" + bossname;
    var boss = new Boss(bossname, 2, 2, 3, 6, tierName)
    bossObjectArray.push(boss);
  }i=0;} else if (i===1){
    Tier = ["Imonar", "Kin", "Vari", "Coven"];
    tierName = "Tier1";
    for (i=0; i <4; i++){
    bossname = Tier[i];
    boss = "Boss" + bossname;
    var boss = new Boss(bossname, 2, 2, 3, 6, tierName)
    bossObjectArray.push(boss);
  }i=1;} else {
    Tier = ["Aggramar", "Argus"];
    tierName = "Tier2";
    for (i=0; i <2; i++){
    bossname = Tier[i];
    boss = "Boss" + bossname;
    var boss = new Boss(bossname, 2, 2, 3, 6, tierName)
    bossObjectArray.push(boss);
  }}}
lines = ["Vala", "healer", "01000"];
line1 = ["Haseo", "DPSr", "00000"];
line2 = ["Bossly", "tank", "10000"];
line3 = ["Ilne", "DPSm", "00010"];
columns = ["Argus", "Aggramar", "Coven"]
raiderObjects = [];
for (i=0; i<5; i++) {
  var raider = "raider" + i;
  if (i === 0){
    lines = ["Vala", "healer", "00100"];
  } else if (i === 1){
    lines = ["Haseo", "DPSr", "00001"];
  } else if (i === 2){
    lines = ["Bossly", "tank", "10000"];
  }  else if (i===3){
    lines = ["Yrall", "healer", "10001"]
  } else {
    lines = ["Ilne", "DPSx", "00010"];
  }
  var raider = new Raider("ID?", lines[0], lines[1], lines[2]);
  raiderObjects.push(raider);
}

function otherrows(raiders, nofcolumns, row, rown){
  for (i=0; i<nofcolumns; i++) {
        var cell = row.insertCell(i);
          if (i===0){
            createCell1(cell, row, i, raiders, rown)
      } else if (i===1) {
        cell.innerHTML = raiderObjects[rown-1].roleN;
      } else {
          createCell(cell, rown, i)
        }} i = rown
}
function createCell1(cell, row, i, raiders, rown){
  RowId = row;
  cell.innerHTML =
  "<button class ='accDec' onclick='setAcc(this)' id=('accepted' + RowId)><i class='fa fa-check' style='color:DarkSeaGreen'></i></button>"+
  "<button class ='accDec' onclick='setDec(this)' id=('declined' + RowId)><i class='fa fa-close' style='color:darkslategray'></i></button>"+
  "<button id=('nameText' + RowId) class='RnameText'>"+raiderObjects[rown-1].nameN+"</button>";
  cell.style.width="130px";
}

function createCell(cell, rown, i) {
  cellid = "r" + [rown] + "c" + [i];
  setdraftid = "setDraftStatus" + cellid;
  cell.innerHTML =
  "<button id="+setdraftid+" class='tbutton' onclick='setDraftStatus(this," + rown +", "+ i + ")'></button>" +
  "<button class='sitButton' id=('setStandby' + cellid) onclick='setAsStandby(this,"+i+", "+rown+")'></button>";
  document.getElementById(setdraftid).innerText = "-";
}

function setAsStandby(button, i, rown) {
  var standbyTicked = button.parentElement.getElementsByClassName("tbutton")[0];
  standbyTicked.style.backgroundColor = "darkslategray";
  standbyTicked.innerText = "standby";
  standbyTicked.style.color = "white";
  var table = document.getElementById("draftTable");
  table.rows[rown].cells[i].class ="standbyclass";
  var cellnu = i;
  counterTableShow(cellnu);
}
function setColour(varName, bcCol, textCol, borderCol) {
  varName.style.backgroundColor = bcCol;
  varName.style.border = borderCol;
  varName.style.color = textCol;
}
function setAcc(button) {
  var varName = button.parentElement.getElementsByClassName("RnameText")[0];
  if (varName.style.backgroundColor == "darkseagreen") {
    var bcCol = "white";
    var textCol = "black";
    var borderCol = "white";
        button.parentElement.class = "notchosen";
    setColour(varName, bcCol, textCol, borderCol)
  } else {
    var bcCol = "DarkSeaGreen";
    var textCol = "white";
    var borderCol = "DarkSeaGreen";
        button.parentElement.class = "acces";
    setColour(varName, bcCol, textCol, borderCol)
  }}
function setDec(button){
  var varName = button.parentElement.getElementsByClassName("RnameText")[0];
  if (varName.style.backgroundColor == "darkslategray") {
    var bcCol = "white";
    var textCol = "black";
    var borderCol = "white";
    button.parentElement.class = "notchosen";
    setColour(varName, bcCol, textCol, borderCol)
  } else {
    var bcCol = "darkslategray";
    var textCol = "white";
    var borderCol = "darkslategray";
    button.parentElement.class = "decl";
    setColour(varName, bcCol, textCol, borderCol)
  }}

function createfirstrow(bosses, nofcolumns, row, rown){
  for (i=0; i<nofcolumns; i++) {
    var cell = row.insertCell(i);
      if (i===0){
        cell.innerHTML = "";
      } else if (i===1){
        cell.innerHTML = "R";
      } else
    cell.innerHTML = bosses[i-2].Bname;
    cell.style.textAlign="center";
    cell.style.height="50px";
  } i = rown
}
function createTable(bosses){
    var table = document.getElementById("draftTable");
    var raiders = ["Vala", "Haseo", "Ilnezhara"];
    var nofrows = raiderObjects.length + 1;
    var nofcolumns = bosses.length + 2;
    for (i=0; i<nofrows; i++){
      var rown = i
      var row = table.insertRow(i);
      if (i === 0) {
        createfirstrow(bosses, nofcolumns, row, rown)
      } else {
        otherrows(raiders, nofcolumns, row, rown)
      }
    }}
function setDraftStatus(button, rown, i){
    var cellnu = i;
      var table = document.getElementById("draftTable");
      table.rows[rown].cells[i].class ="notstandby";
      counterTableShow(cellnu);
      var vala = raiderObjects[rown-1].offroleN;
      var raiderStatus = button
      raiderStatus.style.color = "black";
      if (raiderStatus.innerText === "DPS") {
        if ((vala.charAt(3)) === "1") {
          raiderStatus.innerText = "tank";
          raiderStatus.style.backgroundColor = "lightgray";
        } else if ((vala.charAt(2)) === "1") {
          raiderStatus.innerText = "healer";
          raiderStatus.style.backgroundColor = "DarkSeaGreen";
        } else {
            raiderStatus.innerText = "-";
            raiderStatus.style.backgroundColor = "white";
      }} else if (raiderStatus.innerText === "tank") {
            if ((vala.charAt(2)) === "1") {
            raiderStatus.innerText = "healer";
            raiderStatus.style.backgroundColor = "DarkSeaGreen";
          } else {
          raiderStatus.innerText = "-";
          raiderStatus.style.backgroundColor = "white";
      }} else if (raiderStatus.innerText === "-") {
      raiderStatus.innerText = "x";
      raiderStatus.style.backgroundColor = "lavender";
    } else if (raiderStatus.innerText === "x") {
        if ((vala.charAt(0)) === "1" || (vala.charAt(1)) === "1") {
        raiderStatus.innerText = "DPS";
        raiderStatus.style.backgroundColor = "lightblue";
      } else if ((vala.charAt(3)) === "1") {
        raiderStatus.innerText = "tank";
        raiderStatus.style.backgroundColor = "lightgray";
      } else if ((vala.charAt(2)) === "1") {
        raiderStatus.innerText = "healer";
        raiderStatus.style.backgroundColor = "DarkSeaGreen";
    } else {
        raiderStatus.innerText = "-";
        raiderStatus.style.backgroundColor = "white";
  }} else {
        raiderStatus.innerText = "-";
        raiderStatus.style.backgroundColor = "white";
    }}
function showDeclined(){
  var table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  for (i=1; i<nofr; i++){
      table.rows[i].style.display = "";
    }
    document.getElementById("numAcc").innerText = "";
}
function sortTable(){
  var table, rows, switching, i, x, y, shouldSwitch;
  table = document.getElementById("draftTable");
  switching = true;
  while (switching) {
    switching = false;
    rows = table.getElementsByTagName("TR");
    for (i=1; i< (rows.length -1); i++) {
      shouldSwitch = false;
      x = rows[i].getElementsByTagName("TD")[1];
      y = rows[i + 1].getElementsByTagName("TD")[1];
      if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
        shouldSwitch = true;
        break;
      }
    } if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
    }
  }
}
function separateHealers(){
  var table, rows, columns, i, x, y, z;
  table = document.getElementById("draftTable");
  rows = table.getElementsByTagName("TR");
  columns = document.getElementById('draftTable').rows[0].cells.length;
  healcol = "#c3a2a2";
    for (i=1; i< (rows.length -1); i++) {
      numb = i;
      x = rows[i].getElementsByTagName("TD")[1];
      y = rows[i + 1].getElementsByTagName("TD")[1];
      if (x.innerHTML ==="tank" && y.innerHTML ==="healer") {
        var firstHealer = i + 1;
        for (i=1; i<columns; i++) {
          z = rows[firstHealer].getElementsByTagName("TD")[i];
          z.style.backgroundColor= healcol;
        } i = numb;
      } else if (x.innerHTML ==="healer" && y.innerHTML ==="DPSx") {
      var lastHealer = i;
      for (i=1; i<columns; i++) {
        z = rows[numb].getElementsByTagName("TD")[i];
        z.style.backgroundColor= healcol;
      } i = numb;
    } else if (x.innerHTML === "healer"){
      for (i=1; i<columns; i++) {
        z = rows[numb].getElementsByTagName("TD")[i];
        z.style.backgroundColor= healcol;
    } i = numb;
  }
}}
function hideRoleColumn(){
  var table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  for (i=0; i<nofr; i++){
    table.rows[i].cells[1].style.display = "none";
}}
function tableLoad(){
  createTable(bossObjectArray);
  sortTable();
  separateHealers();
  hideRoleColumn();
  createCountertable();
  createTierList();
  table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  for (i=0; i<nofr; i++){
    table.rows[i].style.display = "none";
}}
function showBossColumn(saveBosses){
  var table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  for (i=0; i<bossObjectArray.length; i++) {
    bossi = bossObjectArray[i];
  if (saveBosses.includes(bossi.Bname)){
  cell = i + 2;
  for (i=0; i<nofr; i++){
    table.rows[i].cells[cell].style.display = "";
} i = cell -2;
}}}
function hideDeclined(){
  var table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  var numAcce = 0;
  for (i=1; i<nofr; i++){
    var cellstatus = table.rows[i].cells[0];
    if (cellstatus.class === "decl") {
      table.rows[i].style.display = "none";
    } else if(cellstatus.class === "acces") {
      numAcce = numAcce + 1;
    }  }
  document.getElementById("numAcc").innerText = "Total Accepted: " + numAcce;
}
function createCountertable(){
  var table = document.getElementById("countertable");
  row = table.insertRow(0);
  columns = document.getElementById('draftTable').rows[0].cells.length - 1;
  for (i=0; i<columns; i++) {
    if (i===0) {
    var cell = row.insertCell(i);
    cell.innerText = "n. to sit:";
  } else {
  var cell = row.insertCell(i);
  var clicks = 0;
  cell.innerHTML = clicks;
}}}
function counterTableShow(cellnu){
  var table = document.getElementById("draftTable");
  var nofr = table.rows.length;
  var numSby = 0;
  for (i=1; i<nofr; i++){
    var cellstatus = table.rows[i].cells[cellnu];
    if (cellstatus.class === "standbyclass") {
      numSby = numSby + 1;
    }}
  var ctable = document.getElementById("countertable");
  totnum = document.getElementById("numAcc").innerHTML;
  ctable.rows[0].cells[cellnu-1].innerHTML = totnum + " - " + numSby;
  }
function createTierList(){
  var noftiers = 3;
  for (i=0; i<noftiers; i++){
    buttonid = "b" + i;
    document.getElementById("tierSelection").innerHTML +=
    "<button id="+buttonid+" onclick='showTierBosses(this)'>"+i+"</button>"
  }
}
function showTierBosses(button){
  i = button.innerHTML;
  tierchosen = tiers[i];
  tiern = "Tier"+i;
  var tierchoices = document.getElementById("tiersBosses");
  tierchoices.innerHTML ="<br>";
  bossesChosen = [];
  for (i=0; i<bossObjectArray.length; i++){
    if (bossObjectArray[i].Btier === tiern){
      checkboxname = "boss" +i;
      idname = bossObjectArray[i].Bname;
    tierchoices.innerHTML +=
    "<input id="+idname+" class='bossCheckBox' type = 'checkbox' name="+checkboxname+">"+idname + " ";
    }}
  tierchoices.innerHTML += "<br>" + "<br>" + "<button onclick ='selectBosses()'>Select</button>"
}
function selectBosses(){
  saveBosses = [];
  bossesChosen = document.getElementsByClassName("bossCheckBox");
  for (i=0; i<bossesChosen.length; i++){
    if (bossesChosen[i].checked) {
      bossnam = bossesChosen[i].id;
      saveBosses.push(bossnam);
  }
} if (saveBosses.length > 0) {
  showBossColumn(saveBosses);
}}

</script>
</head>
<body onload = "tableLoad()">
<table id="draftTable" cellspacing="0">
</table>
<table id="countertable" cellspacing="0" class ="counttable"></table>
<br><br>
<p id="numAcc"></p><button id="HiShow" class ="tableButtons" onclick="showDeclined()">Show All</button><br>
<button id="HiDe" class ="tableButtons" onclick="hideDeclined()">Hide Declined</button>
<p style="display:none">
  <button class ="accDec" onclick="setAcc()" id="accepted"><i class="fa fa-check" style="color:DarkSeaGreen"></i></button>
  <button class ="accDec" onclick="setDec()" id="declined"><i class="fa fa-close" style="color:darkslategray"></i></button>
  <button id="nameText" class="RnameText">Name</button>
  <button class="tbutton" onclick="setDraftStatus(this)">-</button>
  <button class="sitButton" id="setStandby" onclick="setAsStandby()"></button></p>
  <br><br><br><br><p class="subtitle">DRAFT FOR BOSSES:</p><div id = "tierSelection" class="tierSelectionBar">
  </div>
  <p id="tiersBosses"></p>
</body>
</html>
